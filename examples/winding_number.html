<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="shortcut icon" href="../favicon.ico"/>
  <title>Explanarian - Some Fancy Transformations</title>
  <script src="../src/lib/three.js"></script>
  <script src="../src/lib/socket.io.js"></script>
  <script src="../src/lib/OrbitControls.js"></script>
  <script src="../src/js/typechecks.js"></script>
  <script src="../src/js/constants.js"></script>
  <script src="../src/js/math.js"></script>
  <script src="../src/js/Point.js"></script>
  <script src="../src/js/PointOutput.js"></script>
  <script src="../src/js/ComplexPoint.js"></script>
  <script src="../src/js/Animation.js"></script>
  <script src="../src/js/asyncDelayFunctions.js"></script>
  <script src="../src/js/Area.js"></script>
  <script src="../src/js/Transformation.js"></script>
  <script src="../src/js/three_bootstrap.js"></script>

  <link type="text/css" rel="stylesheet" href="../src/style.css" />

  <meta name="viewport" content="initial-scale=1, maximum-scale=1">
</head>
<body>
  <script>
	var three = new Threeasy_Setup(true, 60,15);
	var controls = new THREE.OrbitControls(three.camera,three.renderer.domElement);

	console.log("Loaded.");

	var area = new Area({bounds: [[-5,5],[-5,5]]});
	var a2 = new Area({bounds: [[-5,5]], numItems: 50});
	var id = new Transformation({'expr': (i,t,x,y) => [x,y,0]});
	var output = new PointOutput({width:0.2});

	area.add(new PointOutput({width: 0.2, color:0xcccccc})); // grid

	a2.add(id); //transformation -> output
	id.add(output);

	three.on("update",function(time){
		area.activate(time.t);
		a2.activate(time.t);
		controls.update();
	});

	async function animate(){

		await delay(1000);

		//demonstrate some common functions
		function radius(theta){
			return Math.sin(theta*0.5) + Math.sin(theta*3) + Math.sin(theta*7) + 3.1;
		}

		
		TransitionTo(id, {'expr': (i,t,x,y) => [Math.cos(t)*radius(t),Math.sin(t)*radius(t),0]});
		await delay(8000);

		TransitionTo(id, {'expr': (i,t,x,y) => [Math.cos(x+t)*radius(x+t),Math.sin(x+t)*radius(x+t),0]});
		await delay(5000);

		TransitionTo(id, {'expr': (i,t,x,y) => [Math.cos(x+t),Math.sin(x+t),0]});
		await delay(3000);

	}
	animate();
  </script>
</body>
</html>
