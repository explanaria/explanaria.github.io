<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="shortcut icon" href="../../favicon.ico"/>
  <title>Explanarian - How Congruent Numbers Form Elliptic Curves</title>
  <script src="../../src/lib/three.js"></script>
  <script src="../../src/lib/CCapture.all.min.js"></script>
  <script src="../../src/lib/OrbitControls.js"></script>
  <script src="../../src/js/typechecks.js"></script>
  <script src="../../src/js/constants.js"></script>
  <script src="../../src/js/math.js"></script>
  <script src="../../src/js/Point.js"></script>
  <script src="../../src/js/PointOutput.js"></script>
  <script src="../../src/js/LineOutput.js"></script>
  <script src="../../src/js/Director.js"></script>
  <script src="../../src/js/ComplexPoint.js"></script>
  <script src="../../src/js/Animation.js"></script>
  <script src="../../src/js/asyncDelayFunctions.js"></script>
  <script src="../../src/js/Area.js"></script>
  <script src="../../src/js/Transformation.js"></script>
  <script src="../../src/js/three_bootstrap.js"></script>

  <link type="text/css" href="../../src/style.css" rel="stylesheet" />

  <meta name="viewport" content="initial-scale=1, maximum-scale=1">
</head>
<body>
  <script>
	var three = new Threeasy_Setup(true, 120,10);
	var controls = new THREE.OrbitControls(three.camera,three.renderer.domElement);

	three.camera.position.set(0,-10,10);
	three.camera.lookAt(new THREE.Vector3(0,0,5));

	console.log("Loaded.");

	//a^2 + b^2 = c^2
	//1/2ab = n

	var n = 5

	//a^2+b^2=c^2
	var area = new EXP.Area({bounds: [[-5,5],[-5,5]],numItems:30});
	var pythagoreanConstraint = new EXP.Transformation({'expr': (i,t,a,b) => [a,b,0]});
	var proj1 = new EXP.Transformation({'expr':(i,t,a,b,c) => [a,b,c]});
	var output2 = new EXP.LineOutput({width:5,color:0x0070f0});


	area.add(pythagoreanConstraint).add(proj1).add(output2);

	// 1/2ab = n
	var area2 = new EXP.Area({bounds: [[0,10],[-5,5]],numItems:30});
	var areaConstraint = new EXP.Transformation({'expr': (i,t,c,a) => [Math.abs(a) > 0.3 ? a : NaN,n/a/2,0]});
	var proj2 = new EXP.Transformation({'expr':(i,t,a,b,c) => [a,b,c]});

	area2.add(areaConstraint).add(proj2).add(new EXP.LineOutput({width:5,color:0x7000f0}));

	three.on("update",function(time){
		area.activate(time.t);
		area2.activate(time.t);
	});

	async function animate(){
		//
		TransitionTo(pythagoreanConstraint, {'expr': (i,t,a,b) => [a,b,a*a+b*b]});

		await delay(2000);

		TransitionTo(areaConstraint, {'expr': (i,t,c,a) => [Math.abs(a) > 0.3 ? a : NaN,n/a/2,c]});

		//TransitionTo(areaConstraint, {'expr': (i,t,a,b) => [a,b,a*b/2]});

		await delay(5000);

		//does this project into homogenous coordinates like the paper does? I don't think so - isn't this only RP2? RP3 embedded in Euclidean space requires a 4-sphere, doesn't it. man I really want to geometrically show that this is an elliptic curve
		//TransitionTo(proj1, {'expr': function(i,t,a,b,c){let z = Math.sqrt(a*a+b*b+c*c); return [a/z,b/z,c/z]}});
		//TransitionTo(proj2, {'expr': function(i,t,a,b,c){let z = Math.sqrt(a*a+b*b+c*c); return [a/z,b/z,c/z]}});

		//TransitionTo(proj1, {'expr': function(i,t,asq,b,csq){let c = Math.sqrt(csq), a = Math.sqrt(asq); return [n*b/(c-a),2*n*n/(c-a),0]}});
		
		

	}
	animate();
  </script>
</body>
</html>
